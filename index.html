<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8" />
<title>Quizonator</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" /> <title>Quizonator</title>
<style>
    body {
        font-family: Arial, sans-serif;
        background: #f4f4f4;
        margin: 0;
        padding: 20px;
    }
    .app {
        max-width: 800px;
        margin: 0 auto;
        background: #ffffff;
        border-radius: 8px;
        box-shadow: 0 2px 6px rgba(0,0,0,0.15);
        padding: 20px 25px 30px;
    }
    h1 {
        text-align: center;
        margin-top: 0;
    }
    .hidden {
        display: none;
    }
    textarea {
        width: 100%;
        height: 200px;
        font-family: Consolas, monospace;
        font-size: 13px;
        box-sizing: border-box; /* Zapewnia poprawne wymiary na mobile */
    }
    label {
        font-weight: bold;
    }
    .row {
        margin-top: 15px;
    }
    .controls {
        margin-top: 15px;
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
        align-items: center;
    }
    input[type="number"] {
        width: 80px;
        padding: 5px;
    }
    button {
        padding: 7px 16px;
        border-radius: 4px;
        border: none;
        cursor: pointer;
        background: #1976d2;
        color: #fff;
        font-weight: bold;
    }
    button:disabled {
        background: #9e9e9e;
        cursor: default;
    }
    .quiz-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 8px;
    }
    .quiz-question {
        font-size: 16px;
        font-weight: bold;
        margin-bottom: 10px;
    }
    .answers {
        margin-top: 10px;
    }
    .answer-option {
        display: flex;
        align-items: center;
        gap: 6px;
        padding: 4px 7px;
        border-radius: 4px;
        margin-bottom: 4px;
    }
    .answer-option.correct {
        background-color: #c8e6c9;
    }
    .answer-option.incorrect {
        background-color: #ffcdd2;
    }
    .feedback {
        margin-top: 10px;
        font-weight: bold;
    }
    .feedback.ok {
        color: #2e7d32;
    }
    .feedback.bad {
        color: #c62828;
    }
    .nav-buttons {
        margin-top: 15px;
        display: flex;
        justify-content: space-between;
        gap: 10px;
    }
    .progress {
        font-size: 14px;
        color: #555;
    }
    .summary-item {
        border: 1px solid #ddd;
        border-radius: 6px;
        padding: 8px 10px;
        margin-bottom: 8px;
        background: #fafafa;
    }
    .summary-item h3 {
        margin: 0 0 4px;
        font-size: 14px;
    }
    .summary-correct {
        color: #2e7d32;
        font-weight: bold;
    }
    .summary-wrong {
        color: #c62828;
        font-weight: bold;
    }
    .summary-block {
        margin-top: 3px;
        padding-left: 10px;
        font-size: 13px;
    }
    .summary-block div {
        margin-bottom: 2px;
    }

    /* --- DODANO DLA RESPONSYWNOŚCI --- */
    @media (max-width: 600px) {
        body {
            padding: 10px;
        }
        .app {
            padding: 15px;
        }
        .controls {
            flex-direction: column;
            align-items: flex-start;
        }
        .controls button, .nav-buttons button, #summaryBackToMenuBtn {
            width: 100%;
            padding: 12px; /* Większe przyciski na telefon */
        }
        .nav-buttons {
            flex-direction: column;
        }
        .quiz-header {
            flex-direction: column;
            align-items: flex-start;
            gap: 5px;
        }
    }
</style>
</head>
<body>
<div class="app">
    <h1>Quizonator</h1>

    <!-- MENU GŁÓWNE -->
    <div id="menuScreen">
        <div class="row">
            <label for="questionsInput">Pytania (gwiazdka * przy poprawnych):</label>
            <textarea id="questionsInput"></textarea>
        </div>

        <div class="row controls">
            <label for="questionCount">Ile pytań wylosować:</label>
            <input type="number" id="questionCount" min="1" value="5" />
            <button id="startBtn">Start</button>
        </div>
    </div>

    <!-- EKRAN QUIZU -->
    <div id="quizScreen" class="hidden">
        <div class="quiz-header">
            <div id="quizQuestionNumber"></div>
            <div id="quizProgress" class="progress"></div>
        </div>
        <div id="quizQuestionText" class="quiz-question"></div>
        <div id="quizAnswers" class="answers"></div>
        <div id="quizFeedback" class="feedback"></div>

        <div class="nav-buttons">
            <button id="backToMenuBtn">Powrót do menu</button>
            <button id="prevQuestionBtn">Cofnij</button>
            <button id="checkNextBtn">Sprawdź</button>
        </div>
    </div>

    <!-- PODSUMOWANIE -->
    <div id="summaryScreen" class="hidden">
        <h2>Podsumowanie</h2>
        <div id="summaryResult"></div>
        <div id="summaryList"></div>
        <div class="row">
            <button id="summaryBackToMenuBtn">Powrót do menu</button>
        </div>
    </div>
</div>

<script>
// PRZYKŁADOWE PYTANIA - PODMIENIASZ NA SWOJE
const RAW_QUESTIONS = `
1.	Rachunek zysków i strat to sprawozdanie finansowe prezentujące:
*a)	wynik finansowy w ujęciu memoriałowym,
b)	odroczony podatek dochodowy,
c)	wpływy i wydatki,
d)	wynik finansowy w ujęciu kasowym.

2.	Zmiana stanu produktów prezentowana jest w rachunku zysków i strat po stronie:
*a)	przychodów ze sprzedaży,
b)	kosztów wytworzenia wyrobów gotowych,
c)	przychodów z pozostałej działalności operacyjnej,
d)	kosztów finansowych.

3.	Rachunek zysków i strat ma układ:
a)	dwustronnej tabeli,
*b)	drabinkowy,
c)	uzależniony od wyboru jednostki.

4.	Rachunek zysków i strat zgodnie z polskim prawem bilansowym sporządzamy w wariancie:
a)	kalkulacyjnym,
b)	porównawczym,
*c)	kalkulacyjnym lub porównawczym w zależności od wyboru jednostki.

5.	Rachunek zysków i strat może zostać sporządzony w wersji:
*a)	standardowej lub uproszczonej dla jednostek małych i mikro,
b)	uproszczonej dla jednostek małych i mikro lub rozwiniętej,
c)	standardowej lub rozwiniętej.

6.	Zmiana stanu produktów ustalona w sposób księgowy to:
*a)	saldo konta Rozliczenie kosztów – Dt lub Ct,
b)	saldo Dt konta Rozliczenie kosztów,
c)	saldo Ct konta Rozliczenie kosztów,
d)	saldo konta Produkcja podstawowa.

7.	Zmiana stanu produktów ustalona w sposób księgowy powinna pozostawać w następującej relacji do zmiany stany produktów ustalonej w sposób bilansowy:
a)	powinna być większa,
b)	powinna być mniejsza,
*c)	powinny być sobie równe.

8.	Zgodnie z polskim prawem bilansowym rachunek zysków i strat sporządzany jest według metody:
a)	netto,
b)	brutto,
*c)	mieszanej,
d)	brutto lub mieszanej.

9.	Zgodnie z polskim prawem bilansowym obowiązującym rachunkiem kosztów jest:
*a)	rachunek kosztów pełnych,
b)	rachunek kosztów zmiennych,
c)	rachunek kosztów docelowych.

10.	Skutki zdarzeń losowych ujmowane są w rachunku zysków i strat w pozycji:
*a)	pozostałe koszty operacyjne,
b)	straty nadzwyczajne,
c)	koszt wytworzenia sprzedanych wyrobów gotowych.

11.	Elementem wspólnym dla bilansu oraz rachunku zysków i strat jest:
*a)	Zysk (strata) netto,
b)	Zysk operacyjny,
c)	Przyrost środków pieniężnych.

12.	Amortyzacja jest elementem rachunku zysków i strat w wariancie:
*a)	Porównawczym,
b)	Kalkulacyjnym,
c)	Poziomym.

13.	Jednym z elementów wyniku finansowego są koszty. Ustalając wynik, uwzględnia się m.in. koszty poniesione na:
a)	Produkcję wytworzoną,
*b)	Produkcję sprzedaną oraz koszty okresu,
c)	Produkcję w toku.

14.	W firmie koszty rodzajowe wynosiły 20 000 zł. Zostały rozliczone następująco: koszty działalności podstawowej 15 000 zł, koszty zarządu 5000 zł. Wyprodukowano 1 000 szt. produktu, a sprzedano 900 sztuk po cenie 20 zł/szt. Wynik finansowy wynosi:
a)	4 500 zł,
b)	0,
*c)	-500 zł,
d)	Żadna z wymienionych odpowiedzi nie jest prawidłowa.

15.	Firma „Korek” posiada akcje przeznaczone do sprzedaży. W bieżącym okresie firma sprzedała 100 szt. Akcji, których cena zbytu wynosiła 20 zł/szt., a cena nabycia 18 zł/szt. W wyniku tych operacji suma bilansowa:
a)	Zmniejszyła się o 200 zł
*b)	Zwiększyła się o 200 zł
c)	Wystąpiły zmiany wyłącznie w aktywach: wzrost środków pieniężnych o 2 000 zł  i zmniejszenie wartości papierów wartościowych przeznaczonych do obrotu o 1800 zł

16.	Spłata przez spółkę długoterminowego kredytu spowoduje:
a)	Obciążenie kosztów finansowych,
b)	Zachowanie tej samej sumy bilansowej,
c)	Zwiększenie sumy bilansowej,
*d)	Zmniejszenie sumy bilansowej.

17.	Rozliczenia międzyokresowe kosztów stanowią składnik:
*a)	Bilansu – aktywów
b)	Bilansu – pasywów
c)	Rachunku zysków i strat – kosztów
`;

// ustaw przykładowe pytania w textarea
document.getElementById('questionsInput').value = RAW_QUESTIONS.trim();

// stan aplikacji
let allQuestions = [];
let quizQuestions = [];
let currentIndex = 0;
let userAnswers = [];      // tablica tablic (indeksy odpowiedzi)
let checkedQuestions = []; // czy konkretne pytanie już sprawdzone
let quizFinished = false;  // czy pokazano już podsumowanie

// PARSOWANIE PYTAŃ
function parseQuestions(raw) {
    const blocks = raw
        .split(/\n\s*\n/)
        .map(b => b.trim())
        .filter(b => b.length > 0);

    const parsed = [];

    blocks.forEach(block => {
        const lines = block
            .split('\n')
            .map(l => l.trim())
            .filter(l => l.length > 0);

        if (lines.length < 2) return;

        const first = lines[0];
        const m = first.match(/^(\d+)\.\s*(.*)$/);
        let qText = first;
        if (m) {
            qText = m[2].trim();
        }

        const answers = [];
        const correctIndexes = [];

        for (let i = 1; i < lines.length; i++) {
            let line = lines[i];
            let isCorrect = false;

            if (line.startsWith('*')) {
                isCorrect = true;
                line = line.substring(1).trim();
            }

            const ansMatch = line.match(/^([a-zA-Z])\)\s*(.*)$/);
            if (!ansMatch) continue;
            const text = ansMatch[2].trim();
            const idx = answers.length;
            answers.push(text);
            if (isCorrect) correctIndexes.push(idx);
        }

        if (answers.length > 0 && correctIndexes.length > 0) {
            parsed.push({
                text: qText,
                answers,
                correctIndexes
            });
        }
    });

    return parsed;
}

// LOSOWANIE PYTAŃ
function pickRandomQuestions(all, n) {
    const idx = all.map((_, i) => i);
    for (let i = idx.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [idx[i], idx[j]] = [idx[j], idx[i]];
    }
    return idx.slice(0, n).map(i => all[i]);
}

// PORÓWNANIE ODPOWIEDZI
function isUserCorrect(user, correct) {
    if (user.length !== correct.length) return false;
    const setU = new Set(user);
    for (const c of correct) {
        if (!setU.has(c)) return false;
    }
    return true;
}

// ZAPIS WYBORU BIEŻĄCEGO PYTANIA
function saveCurrentSelection() {
    const inputs = document.querySelectorAll('#quizAnswers input[name="answer"]');
    const chosen = [];
    inputs.forEach(input => {
        if (input.checked) {
            chosen.push(parseInt(input.value, 10));
        }
    });
    userAnswers[currentIndex] = chosen;
}

// RENDER PYTANIA
function renderQuestion() {
    const q = quizQuestions[currentIndex];
    const qNumEl = document.getElementById('quizQuestionNumber');
    const progressEl = document.getElementById('quizProgress');
    const qTextEl = document.getElementById('quizQuestionText');
    const answersEl = document.getElementById('quizAnswers');
    const feedbackEl = document.getElementById('quizFeedback');
    const prevBtn = document.getElementById('prevQuestionBtn');
    const checkNextBtn = document.getElementById('checkNextBtn');

    const displayNumber = currentIndex + 1;
    qNumEl.textContent = 'Pytanie ' + displayNumber;
    progressEl.textContent = `Pytanie ${displayNumber} z ${quizQuestions.length}`;
    qTextEl.textContent = q.text;

    answersEl.innerHTML = '';
    feedbackEl.textContent = '';
    feedbackEl.className = 'feedback';

    const multiple = q.correctIndexes.length > 1;
    const inputType = multiple ? 'checkbox' : 'radio';
    const correctSet = new Set(q.correctIndexes);
    const user = userAnswers[currentIndex] || [];
    const userSet = new Set(user);
    const alreadyChecked = !!checkedQuestions[currentIndex];

    q.answers.forEach((ans, idx) => {
        const label = document.createElement('label');
        label.className = 'answer-option';

        const input = document.createElement('input');
        input.type = inputType;
        input.name = 'answer';
        input.value = idx;
        if (userSet.has(idx)) {
            input.checked = true;
        }
        if (alreadyChecked) {
            input.disabled = true;
            if (correctSet.has(idx)) {
                label.classList.add('correct');
            }
            if (userSet.has(idx) && !correctSet.has(idx)) {
                label.classList.add('incorrect');
            }
        }

        const span = document.createElement('span');
        span.textContent = ans;

        label.appendChild(input);
        label.appendChild(span);
        answersEl.appendChild(label);
    });

    if (alreadyChecked) {
        const correct = isUserCorrect(user, q.correctIndexes);
        if (correct) {
            feedbackEl.textContent = 'Prawidłowa odpowiedź.';
            feedbackEl.classList.add('ok');
        } else {
            feedbackEl.textContent = 'Błędna odpowiedź.';
            feedbackEl.classList.add('bad');
        }
        if (currentIndex === quizQuestions.length - 1) {
            checkNextBtn.textContent = 'Zakończ';
        } else {
            checkNextBtn.textContent = 'Dalej';
        }
    } else {
        checkNextBtn.textContent = 'Sprawdź';
    }

    prevBtn.disabled = currentIndex === 0;
}

// SPRAWDZENIE PYTANIA
function checkCurrentQuestion() {
    const q = quizQuestions[currentIndex];
    saveCurrentSelection();

    const user = userAnswers[currentIndex] || [];
    if (user.length === 0) {
        alert('Najpierw zaznacz odpowiedź.');
        return;
    }

    checkedQuestions[currentIndex] = true;

    const answersEl = document.getElementById('quizAnswers');
    const feedbackEl = document.getElementById('quizFeedback');
    const checkNextBtn = document.getElementById('checkNextBtn');

    const correctSet = new Set(q.correctIndexes);
    const userSet = new Set(user);

    answersEl.querySelectorAll('.answer-option').forEach((opt, idx) => {
        const input = opt.querySelector('input');
        input.disabled = true;
        if (correctSet.has(idx)) {
            opt.classList.add('correct');
        }
        if (userSet.has(idx) && !correctSet.has(idx)) {
            opt.classList.add('incorrect');
        }
    });

    const correct = isUserCorrect(user, q.correctIndexes);
    if (correct) {
        feedbackEl.textContent = 'Prawidłowa odpowiedź.';
        feedbackEl.className = 'feedback ok';
    } else {
        feedbackEl.textContent = 'Błędna odpowiedź.';
        feedbackEl.className = 'feedback bad';
    }

    if (currentIndex === quizQuestions.length - 1) {
        checkNextBtn.textContent = 'Zakończ';
    } else {
        checkNextBtn.textContent = 'Dalej';
    }
}

// PODSUMOWANIE
function showSummary() {
    quizFinished = true;
    document.getElementById('quizScreen').classList.add('hidden');
    const summaryScreen = document.getElementById('summaryScreen');
    const summaryResult = document.getElementById('summaryResult');
    const summaryList = document.getElementById('summaryList');

    summaryScreen.classList.remove('hidden');
    summaryList.innerHTML = '';

    let correctCount = 0;

    quizQuestions.forEach((q, idx) => {
        const user = userAnswers[idx] || [];
        const correct = q.correctIndexes;
        const isCorrect = isUserCorrect(user, correct);
        if (isCorrect) correctCount++;

        const item = document.createElement('div');
        item.className = 'summary-item';

        const title = document.createElement('h3');
        title.textContent = `Pytanie ${idx + 1}: ${q.text}`;
        item.appendChild(title);

        const status = document.createElement('div');
        status.className = isCorrect ? 'summary-correct' : 'summary-wrong';
        status.textContent = isCorrect
            ? 'Odpowiedź prawidłowa.'
            : 'Odpowiedź błędna – z tym miałeś problem.';
        item.appendChild(status);

        const userBlock = document.createElement('div');
        userBlock.className = 'summary-block';
        const userTitle = document.createElement('div');
        userTitle.textContent = 'To zaznaczyłeś:';
        userBlock.appendChild(userTitle);

        if (user.length === 0) {
            const d = document.createElement('div');
            d.textContent = '- Nic nie zaznaczyłeś.';
            userBlock.appendChild(d);
        } else {
            user.forEach(aIdx => {
                const d = document.createElement('div');
                d.textContent = '- ' + q.answers[aIdx];
                userBlock.appendChild(d);
            });
        }
        item.appendChild(userBlock);

        const correctBlock = document.createElement('div');
        correctBlock.className = 'summary-block';
        const correctTitle = document.createElement('div');
        correctTitle.textContent = 'Prawidłowe odpowiedzi:';
        correctBlock.appendChild(correctTitle);

        correct.forEach(aIdx => {
            const d = document.createElement('div');
            d.textContent = '- ' + q.answers[aIdx];
            correctBlock.appendChild(d);
        });
        item.appendChild(correctBlock);

        summaryList.appendChild(item);
    });

    summaryResult.textContent = `Wynik: ${correctCount} z ${quizQuestions.length} prawidłowych odpowiedzi.`;
}

// RESET DO MENU
function goToMenu() {
    document.getElementById('menuScreen').classList.remove('hidden');
    document.getElementById('quizScreen').classList.add('hidden');
    document.getElementById('summaryScreen').classList.add('hidden');
    quizFinished = false;
}

// ZDARZENIA
document.getElementById('startBtn').addEventListener('click', () => {
    const raw = document.getElementById('questionsInput').value;
    allQuestions = parseQuestions(raw);
    if (allQuestions.length === 0) {
        alert('Brak poprawnie sparsowanych pytań. Sprawdź format.');
        return;
    }

    const desired = parseInt(document.getElementById('questionCount').value, 10) || 1;
    const count = Math.min(Math.max(1, desired), allQuestions.length);

    quizQuestions = pickRandomQuestions(allQuestions, count);
    currentIndex = 0;
    userAnswers = new Array(quizQuestions.length).fill(null).map(() => []);
    checkedQuestions = new Array(quizQuestions.length).fill(false);
    quizFinished = false;

    document.getElementById('menuScreen').classList.add('hidden');
    document.getElementById('summaryScreen').classList.add('hidden');
    document.getElementById('quizScreen').classList.remove('hidden');

    renderQuestion();
});

document.getElementById('backToMenuBtn').addEventListener('click', () => {
    goToMenu();
});

document.getElementById('summaryBackToMenuBtn').addEventListener('click', () => {
    goToMenu();
});

document.getElementById('prevQuestionBtn').addEventListener('click', () => {
    saveCurrentSelection();
    if (currentIndex > 0) {
        currentIndex--;
        renderQuestion();
    }
});

document.getElementById('checkNextBtn').addEventListener('click', () => {
    if (!checkedQuestions[currentIndex]) {
        checkCurrentQuestion();
    } else {
        // już sprawdzone -> idziemy dalej albo kończymy
        saveCurrentSelection();
        if (currentIndex === quizQuestions.length - 1) {
            showSummary();
        } else {
            currentIndex++;
            renderQuestion();
        }
    }
});
</script>
</body>
</html>



